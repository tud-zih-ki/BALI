<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="602pt" height="774pt"
 viewBox="0.00 0.00 602.00 774.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 770)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-770 598,-770 598,4 -4,4"/>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M545,-766C545,-766 405,-766 405,-766 399,-766 393,-760 393,-754 393,-754 393,-742 393,-742 393,-736 399,-730 405,-730 405,-730 545,-730 545,-730 551,-730 557,-736 557,-742 557,-742 557,-754 557,-754 557,-760 551,-766 545,-766"/>
<text text-anchor="middle" x="475" y="-745.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Dataset and DataLoader setup</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M535.5,-693C535.5,-693 414.5,-693 414.5,-693 408.5,-693 402.5,-687 402.5,-681 402.5,-681 402.5,-669 402.5,-669 402.5,-663 408.5,-657 414.5,-657 414.5,-657 535.5,-657 535.5,-657 541.5,-657 547.5,-663 547.5,-669 547.5,-669 547.5,-681 547.5,-681 547.5,-687 541.5,-693 535.5,-693"/>
<text text-anchor="middle" x="475" y="-672.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Process DataLoader batch</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="#000000" d="M475,-729.9551C475,-721.8828 475,-712.1764 475,-703.1817"/>
<polygon fill="#000000" stroke="#000000" points="478.5001,-703.0903 475,-693.0904 471.5001,-703.0904 478.5001,-703.0903"/>
</g>
<!-- C -->
<g id="node3" class="node">
<title>C</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M498.5,-620C498.5,-620 321.5,-620 321.5,-620 315.5,-620 309.5,-614 309.5,-608 309.5,-608 309.5,-596 309.5,-596 309.5,-590 315.5,-584 321.5,-584 321.5,-584 498.5,-584 498.5,-584 504.5,-584 510.5,-590 510.5,-596 510.5,-596 510.5,-608 510.5,-608 510.5,-614 504.5,-620 498.5,-620"/>
<text text-anchor="middle" x="410" y="-599.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Model inference (softmax probabilities)</text>
</g>
<!-- B&#45;&gt;C -->
<g id="edge2" class="edge">
<title>B&#45;&gt;C</title>
<path fill="none" stroke="#000000" d="M458.9326,-656.9551C451.0419,-648.0932 441.3974,-637.2616 432.763,-627.5646"/>
<polygon fill="#000000" stroke="#000000" points="435.3718,-625.2313 426.1079,-620.0904 430.1439,-629.8863 435.3718,-625.2313"/>
</g>
<!-- D -->
<g id="node4" class="node">
<title>D</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M475,-547C475,-547 339,-547 339,-547 333,-547 327,-541 327,-535 327,-535 327,-523 327,-523 327,-517 333,-511 339,-511 339,-511 475,-511 475,-511 481,-511 487,-517 487,-523 487,-523 487,-535 487,-535 487,-541 481,-547 475,-547"/>
<text text-anchor="middle" x="407" y="-526.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Process each sample in batch</text>
</g>
<!-- C&#45;&gt;D -->
<g id="edge3" class="edge">
<title>C&#45;&gt;D</title>
<path fill="none" stroke="#000000" d="M409.2584,-583.9551C408.9267,-575.8828 408.5278,-566.1764 408.1582,-557.1817"/>
<polygon fill="#000000" stroke="#000000" points="411.6512,-556.9382 407.7434,-547.0904 404.6571,-557.2257 411.6512,-556.9382"/>
</g>
<!-- E -->
<g id="node5" class="node">
<title>E</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M356,-474C356,-474 236,-474 236,-474 230,-474 224,-468 224,-462 224,-462 224,-450 224,-450 224,-444 230,-438 236,-438 236,-438 356,-438 356,-438 362,-438 368,-444 368,-450 368,-450 368,-462 368,-462 368,-468 362,-474 356,-474"/>
<text text-anchor="middle" x="296" y="-453.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Mask padding tokens</text>
</g>
<!-- D&#45;&gt;E -->
<g id="edge4" class="edge">
<title>D&#45;&gt;E</title>
<path fill="none" stroke="#000000" d="M379.5618,-510.9551C365.2864,-501.5667 347.6496,-489.9678 332.2637,-479.8491"/>
<polygon fill="#000000" stroke="#000000" points="333.7855,-476.6609 323.5073,-474.0904 329.9392,-482.5095 333.7855,-476.6609"/>
</g>
<!-- F -->
<g id="node6" class="node">
<title>F</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M349,-401C349,-401 137,-401 137,-401 131,-401 125,-395 125,-389 125,-389 125,-377 125,-377 125,-371 131,-365 137,-365 137,-365 349,-365 349,-365 355,-365 361,-371 361,-377 361,-377 361,-389 361,-389 361,-395 355,-401 349,-401"/>
<text text-anchor="middle" x="243" y="-380.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Convert token IDs to tokens (model tokenizer)</text>
</g>
<!-- E&#45;&gt;F -->
<g id="edge5" class="edge">
<title>E&#45;&gt;F</title>
<path fill="none" stroke="#000000" d="M282.8989,-437.9551C276.656,-429.3564 269.0668,-418.9034 262.1901,-409.4316"/>
<polygon fill="#000000" stroke="#000000" points="264.8415,-407.1262 256.1341,-401.0904 259.177,-411.2388 264.8415,-407.1262"/>
</g>
<!-- G -->
<g id="node7" class="node">
<title>G</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M356,-328C356,-328 12,-328 12,-328 6,-328 0,-322 0,-316 0,-316 0,-304 0,-304 0,-298 6,-292 12,-292 12,-292 356,-292 356,-292 362,-292 368,-298 368,-304 368,-304 368,-316 368,-316 368,-322 362,-328 356,-328"/>
<text text-anchor="middle" x="184" y="-307.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Merge tokens to words and calculate word probabilities (openai tokenizer)</text>
</g>
<!-- F&#45;&gt;G -->
<g id="edge6" class="edge">
<title>F&#45;&gt;G</title>
<path fill="none" stroke="#000000" d="M228.4157,-364.9551C221.3952,-356.2686 212.8452,-345.6898 205.1285,-336.142"/>
<polygon fill="#000000" stroke="#000000" points="207.629,-333.6677 198.621,-328.0904 202.1848,-338.0678 207.629,-333.6677"/>
</g>
<!-- H -->
<g id="node8" class="node">
<title>H</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M229,-255C229,-255 109,-255 109,-255 103,-255 97,-249 97,-243 97,-243 97,-231 97,-231 97,-225 103,-219 109,-219 109,-219 229,-219 229,-219 235,-219 241,-225 241,-231 241,-231 241,-243 241,-243 241,-249 235,-255 229,-255"/>
<text text-anchor="middle" x="169" y="-234.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Calculate threshold</text>
</g>
<!-- G&#45;&gt;H -->
<g id="edge7" class="edge">
<title>G&#45;&gt;H</title>
<path fill="none" stroke="#000000" d="M180.2921,-291.9551C178.6154,-283.7951 176.5956,-273.9652 174.7306,-264.8887"/>
<polygon fill="#000000" stroke="#000000" points="178.1584,-264.1812 172.7172,-255.0904 171.3016,-265.5902 178.1584,-264.1812"/>
</g>
<!-- I -->
<g id="node9" class="node">
<title>I</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M213,-182C213,-182 77,-182 77,-182 71,-182 65,-176 65,-170 65,-170 65,-158 65,-158 65,-152 71,-146 77,-146 77,-146 213,-146 213,-146 219,-146 225,-152 225,-158 225,-158 225,-170 225,-170 225,-176 219,-182 213,-182"/>
<text text-anchor="middle" x="145" y="-161.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Discard low&#45;probability tokens</text>
</g>
<!-- H&#45;&gt;I -->
<g id="edge8" class="edge">
<title>H&#45;&gt;I</title>
<path fill="none" stroke="#000000" d="M163.0674,-218.9551C160.3558,-210.7074 157.0834,-200.7536 154.0727,-191.5962"/>
<polygon fill="#000000" stroke="#000000" points="157.3957,-190.497 150.9475,-182.0904 150.7459,-192.6833 157.3957,-190.497"/>
</g>
<!-- I&#45;&gt;I -->
<g id="edge11" class="edge">
<title>I:e&#45;&gt;I:e</title>
<path fill="none" stroke="#8b008b" d="M225,-164C231,-173 243,-173 243,-164 243,-158.2344 238.0752,-156.1624 232.958,-157.7839"/>
<polygon fill="#8b008b" stroke="#8b008b" points="230.7263,-155.0859 225,-164 235.0353,-160.6025 230.7263,-155.0859"/>
<text text-anchor="middle" x="311" y="-161.2" font-family="Arial" font-size="11.00" fill="#000000">Repeat for remaining tokens</text>
</g>
<!-- J -->
<g id="node10" class="node">
<title>J</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M540.5,-109C540.5,-109 273.5,-109 273.5,-109 267.5,-109 261.5,-103 261.5,-97 261.5,-97 261.5,-85 261.5,-85 261.5,-79 267.5,-73 273.5,-73 273.5,-73 540.5,-73 540.5,-73 546.5,-73 552.5,-79 552.5,-85 552.5,-85 552.5,-97 552.5,-97 552.5,-103 546.5,-109 540.5,-109"/>
<text text-anchor="middle" x="407" y="-88.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Append compressed sequence to total compressed string</text>
</g>
<!-- I&#45;&gt;J -->
<g id="edge9" class="edge">
<title>I&#45;&gt;J</title>
<path fill="none" stroke="#000000" d="M209.7641,-145.9551C246.9232,-135.6016 293.7313,-122.5596 332.422,-111.7794"/>
<polygon fill="#000000" stroke="#000000" points="333.3793,-115.146 342.073,-109.0904 331.5004,-108.4029 333.3793,-115.146"/>
</g>
<!-- J&#45;&gt;B -->
<g id="edge12" class="edge">
<title>J&#45;&gt;B</title>
<path fill="none" stroke="#4682b4" d="M493.1092,-109.1428C518.6784,-119.9204 540,-137.0018 540,-164 540,-602 540,-602 540,-602 540,-621.3294 527.1315,-637.91 512.846,-650.3612"/>
<polygon fill="#4682b4" stroke="#4682b4" points="510.407,-647.8326 504.8366,-656.845 514.8113,-653.2734 510.407,-647.8326"/>
<text text-anchor="middle" x="567" y="-380.2" font-family="Arial" font-size="11.00" fill="#000000">Next Batch</text>
</g>
<!-- J&#45;&gt;D -->
<g id="edge13" class="edge">
<title>J&#45;&gt;D</title>
<path fill="none" stroke="#a52a2a" d="M407,-109.3003C407,-124.0651 407,-145.3698 407,-164 407,-456 407,-456 407,-456 407,-470.7004 407,-487.066 407,-500.5698"/>
<polygon fill="#a52a2a" stroke="#a52a2a" points="403.5001,-500.6996 407,-510.6997 410.5001,-500.6997 403.5001,-500.6996"/>
<text text-anchor="middle" x="459.5" y="-307.2" font-family="Arial" font-size="11.00" fill="#000000">Next Sample in Batch</text>
</g>
<!-- K -->
<g id="node11" class="node">
<title>K</title>
<path fill="#f0f8ff" stroke="#6b7b8c" d="M479,-36C479,-36 335,-36 335,-36 329,-36 323,-30 323,-24 323,-24 323,-12 323,-12 323,-6 329,0 335,0 335,0 479,0 479,0 485,0 491,-6 491,-12 491,-12 491,-24 491,-24 491,-30 485,-36 479,-36"/>
<text text-anchor="middle" x="407" y="-15.2" font-family="Arial" font-size="11.00" fill="#2f4f4f">Compose final compressed lists</text>
</g>
<!-- J&#45;&gt;K -->
<g id="edge10" class="edge">
<title>J&#45;&gt;K</title>
<path fill="none" stroke="#000000" d="M407,-72.9551C407,-64.8828 407,-55.1764 407,-46.1817"/>
<polygon fill="#000000" stroke="#000000" points="410.5001,-46.0903 407,-36.0904 403.5001,-46.0904 410.5001,-46.0903"/>
</g>
</g>
</svg>
